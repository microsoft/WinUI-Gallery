<!--
    //*********************************************************
    //
    // Copyright (c) Microsoft. All rights reserved.
    // THIS CODE IS PROVIDED *AS IS* WITHOUT WARRANTY OF
    // ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING ANY
    // IMPLIED WARRANTIES OF FITNESS FOR A PARTICULAR
    // PURPOSE, MERCHANTABILITY, OR NON-INFRINGEMENT.
    //
    //*********************************************************
-->
<Page
    x:Class="WinUIGallery.ControlPages.RichEditBoxPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:WinUIGallery.Controls"
    xmlns:converters="using:WinUIGallery.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:helper="using:WinUIGallery.Helpers"
    mc:Ignorable="d">

    <StackPanel>

        <controls:ControlExample
            VerticalAlignment="Top"
            HorizontalContentAlignment="Stretch"
            HeaderText="A simple text editor using RichEditBox.">
            <RichEditBox AutomationProperties.Name="simple text editor" />
            <controls:ControlExample.Xaml>
                <x:String>
                    &lt;RichEditBox x:Name="editor" AutomationProperties.Name="simple text editor"/&gt;
                </x:String>
            </controls:ControlExample.Xaml>
        </controls:ControlExample>

        <controls:ControlExample
            CSharpSource="Text\RichEditBox\RichEditBoxSample4_cs.txt"
            HeaderText="Customizing RichEditBox's CommandBarFlyout - Adding 'Share'"
            XamlSource="Text\RichEditBox\RichEditBoxSample4_Xaml.txt">
            <RichEditBox
                x:Name="REBCustom"
                Width="800"
                Height="200"
                AutomationProperties.Name="editor with custom menu"
                Loaded="REBCustom_Loaded"
                Unloaded="REBCustom_Unloaded" />

        </controls:ControlExample>

        <controls:ControlExample
            VerticalAlignment="Top"
            HorizontalContentAlignment="Stretch"
            CSharpSource="Text\RichEditBox\RichEditBoxSample3_cs.txt"
            HeaderText="A custom editor with RichEditBox."
            XamlSource="Text\RichEditBox\RichEditBoxSample3_Xaml.txt">
            <RelativePanel Margin="0,0,0,20" HorizontalAlignment="Stretch">
                <RelativePanel.Resources>
                    <ResourceDictionary>
                        <Style TargetType="Button">
                            <Setter Property="BorderThickness" Value="0" />
                            <Setter Property="Background" Value="Transparent" />
                            <Setter Property="Margin" Value="0,0,8,0" />
                        </Style>

                        <ResourceDictionary.ThemeDictionaries>
                            <ResourceDictionary x:Key="HighContrast">
                                <StaticResource x:Key="ButtonBackgroundPointerOver" ResourceKey="SystemColorHighlightColor" />
                            </ResourceDictionary>
                        </ResourceDictionary.ThemeDictionaries>
                    </ResourceDictionary>
                </RelativePanel.Resources>
                <Button
                    x:Name="openFileButton"
                    AutomationProperties.Name="Open file"
                    Click="OpenButton_Click"
                    ToolTipService.ToolTip="Open file">
                    <Button.Content>
                        <FontIcon Glyph="&#xE8E5;" />
                    </Button.Content>
                </Button>
                <Button
                    AutomationProperties.Name="Save file"
                    Click="SaveButton_Click"
                    RelativePanel.RightOf="openFileButton"
                    ToolTipService.ToolTip="Save file">
                    <Button.Content>
                        <FontIcon Glyph="&#xE74E;" />
                    </Button.Content>
                </Button>
                <Button
                    AutomationProperties.Name="Bold"
                    Click="BoldButton_Click"
                    RelativePanel.LeftOf="italicButton"
                    ToolTipService.ToolTip="Bold">
                    <Button.Content>
                        <FontIcon Glyph="&#xE8DD;" />
                    </Button.Content>
                </Button>
                <Button
                    x:Name="italicButton"
                    AutomationProperties.Name="Italic"
                    Click="ItalicButton_Click"
                    RelativePanel.LeftOf="fontColorButton"
                    ToolTipService.ToolTip="Italic">
                    <Button.Content>
                        <FontIcon Glyph="&#xE8DB;" />
                    </Button.Content>
                </Button>

                <DropDownButton
                    x:Name="fontColorButton"
                    AutomationProperties.Name="Font color"
                    Background="Transparent"
                    BorderThickness="0"
                    RelativePanel.AlignRightWithPanel="True"
                    ToolTipService.ToolTip="Font color">
                    <SymbolIcon Symbol="FontColor" />
                    <DropDownButton.Flyout>
                        <Flyout Placement="Bottom">
                            <VariableSizedWrapGrid MaximumRowsOrColumns="3" Orientation="Horizontal">
                                <VariableSizedWrapGrid.Resources>
                                    <Style TargetType="Rectangle">
                                        <Setter Property="Width" Value="32" />
                                        <Setter Property="Height" Value="32" />
                                    </Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Padding" Value="0" />
                                        <Setter Property="MinWidth" Value="0" />
                                        <Setter Property="MinHeight" Value="0" />
                                        <Setter Property="Margin" Value="6" />
                                    </Style>
                                </VariableSizedWrapGrid.Resources>
                                <Button AutomationProperties.Name="Red" Click="ColorButton_Click">
                                    <Button.Content>
                                        <Rectangle Fill="Red" />
                                    </Button.Content>
                                </Button>
                                <Button AutomationProperties.Name="Orange" Click="ColorButton_Click">
                                    <Button.Content>
                                        <Rectangle Fill="Orange" />
                                    </Button.Content>
                                </Button>
                                <Button AutomationProperties.Name="Yellow" Click="ColorButton_Click">
                                    <Button.Content>
                                        <Rectangle Fill="Yellow" />
                                    </Button.Content>
                                </Button>
                                <Button AutomationProperties.Name="Green" Click="ColorButton_Click">
                                    <Button.Content>
                                        <Rectangle Fill="Green" />
                                    </Button.Content>
                                </Button>
                                <Button AutomationProperties.Name="Blue" Click="ColorButton_Click">
                                    <Button.Content>
                                        <Rectangle Fill="Blue" />
                                    </Button.Content>
                                </Button>
                                <Button AutomationProperties.Name="Indigo" Click="ColorButton_Click">
                                    <Button.Content>
                                        <Rectangle Fill="Indigo" />
                                    </Button.Content>
                                </Button>
                                <Button AutomationProperties.Name="Violet" Click="ColorButton_Click">
                                    <Button.Content>
                                        <Rectangle Fill="Violet" />
                                    </Button.Content>
                                </Button>
                                <Button AutomationProperties.Name="Gray" Click="ColorButton_Click">
                                    <Button.Content>
                                        <Rectangle Fill="Gray" />
                                    </Button.Content>
                                </Button>
                            </VariableSizedWrapGrid>
                        </Flyout>
                    </DropDownButton.Flyout>
                </DropDownButton>

                <RichEditBox
                    x:Name="editor"
                    Height="200"
                    MinWidth="300"
                    AutomationProperties.Name="Custom editor"
                    GotFocus="Editor_GotFocus"
                    RelativePanel.AlignLeftWithPanel="True"
                    RelativePanel.AlignRightWithPanel="True"
                    RelativePanel.Below="openFileButton"
                    TextChanged="Editor_TextChanged" />
                <StackPanel
                    Margin="0,10,0,0"
                    Orientation="Horizontal"
                    RelativePanel.AlignLeftWith="editor"
                    RelativePanel.Below="editor">
                    <TextBlock
                        x:Name="findBoxLabel"
                        Margin="0,0,0,4"
                        VerticalAlignment="Center"
                        Text="Find:" />
                    <TextBox
                        x:Name="findBox"
                        Width="224"
                        Margin="10,0,0,0"
                        GotFocus="{x:Bind FindBoxHighlightMatches}"
                        LostFocus="{x:Bind FindBoxRemoveHighlights}"
                        PlaceholderText="Enter search text"
                        TextChanged="{x:Bind FindBoxHighlightMatches}" />
                </StackPanel>
            </RelativePanel>
        </controls:ControlExample>

        <controls:ControlExample x:Name="MathModeExample" HeaderText="Rich edit box in math mode">
            <controls:ControlExample.Resources>
                <Style x:Key="ItemStyle1"
                       TargetType="Grid">
                    <Setter Property="Background"
                            Value="{ThemeResource CardBackgroundFillColorDefaultBrush}" />
                </Style>
                <Style x:Key="ItemStyle2"
                       TargetType="Grid">
                    <Setter Property="Background"
                            Value="{ThemeResource CardBackgroundFillColorSecondaryBrush}" />
                </Style>
            </controls:ControlExample.Resources>
            <controls:ControlExample.Example>
                <StackPanel Spacing="8">
                    <TextBlock x:Name="MathModeDescription"
                               TextWrapping="Wrap"/>
                    <RichEditBox x:Name="MathEditor"
                                 Height="160"
                                 Width="478"
                                 FontSize="16"
                                 HorizontalAlignment="Left" />
                    <ScrollViewer HorizontalScrollBarVisibility="Auto"
                                  HorizontalScrollMode="Auto"
                                  VerticalScrollBarVisibility="Hidden"
                                  Margin="0 12 0 0">
                        <SelectorBar Padding="-12 0 0 16" SelectionChanged="SelectorBar_SelectionChanged">
                            <SelectorBarItem Text="Symbols"
                                             IsSelected="True"
                                             Tag="Symbols" />
                            <SelectorBarItem Text="Basic Structures"
                                             Tag="Structures" />
                            <SelectorBarItem Text="Integrals"
                                             Tag="Integrals" />
                            <SelectorBarItem Text="Large Operators"
                                             Tag="LargeOperators" />
                            <SelectorBarItem Text="Accents"
                                             Tag="Accents" />
                            <SelectorBarItem Text="Limit &amp; Functions"
                                             Tag="LimitAndFunctions" />
                            <SelectorBarItem Text="Matrices"
                                             Tag="Matrices"/>
                        </SelectorBar> 
                    </ScrollViewer>
                    <ScrollViewer x:Name="SymbolsTable"
                                  HorizontalScrollBarVisibility="Auto"
                                  HorizontalScrollMode="Auto"
                                  VerticalScrollBarVisibility="Hidden"
                                  BorderThickness="1"
                                  BorderBrush="{ThemeResource SurfaceStrokeColorDefaultBrush}"
                                  CornerRadius="4">
                        <ContentPresenter>
                            <Grid Background="{ThemeResource AcrylicBackgroundFillColorBaseBrush}">
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <Grid HorizontalAlignment="Stretch"
                                      BorderThickness="0,0,0,1"
                                      BorderBrush="{ThemeResource SurfaceStrokeColorDefaultBrush}"
                                      Padding="12 16">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100" />
                                        <ColumnDefinition Width="200" />
                                        <ColumnDefinition Width="150" />
                                        <ColumnDefinition Width="150" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Text="Symbol"
                                               Padding="8 0" />
                                    <TextBlock Grid.Column="1"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Text="Name" />
                                    <TextBlock Grid.Column="2"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Text="Command" />
                                    <TextBlock Grid.Column="3"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Text="Unicode" />
                                </Grid>
                                <ScrollView Grid.Row="1"
                                            HorizontalScrollBarVisibility="Auto"
                                            HorizontalScrollMode="Auto"
                                            MaxHeight="450"
                                            CornerRadius="0">
                                    <ItemsRepeater x:Name="MathSymbolsItems">
                                        <ItemsRepeater.Resources>

                                        </ItemsRepeater.Resources>
                                        <ItemsRepeater.Layout>
                                            <StackLayout x:Name="VerticalStackLayout"
                                                         Orientation="Vertical" />
                                        </ItemsRepeater.Layout>
                                        <ItemsRepeater.ItemTemplate>
                                            <DataTemplate x:DataType="helper:MathSymbol">
                                                <Grid x:Name="SymbolDataTemplate"
                                                      Padding="12"
                                                      Loading="SymbolDataTemplate_Loading"
                                                      BorderThickness="0,0,0,1"
                                                      BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="100" />
                                                        <ColumnDefinition Width="200" />
                                                        <ColumnDefinition Width="150" />
                                                        <ColumnDefinition Width="150" />
                                                    </Grid.ColumnDefinitions>
                                                    <Button x:Name="InsertSymbolBtn"
                                                            Width="48"
                                                            VerticalAlignment="Center"
                                                            Click="InsertSymbolBtn_Click"
                                                            Tag="{x:Bind Command}"
                                                            IsTabStop="False">
                                                        <TextBlock Grid.Column="0"
                                                                   Text="{x:Bind Value}"
                                                                   TextWrapping="Wrap"
                                                                   FontFamily="Cambria"
                                                                   FontWeight="SemiBold" />
                                                        <ToolTipService.ToolTip>
                                                            <x:String>Insert Symbol</x:String>
                                                        </ToolTipService.ToolTip>
                                                    </Button>
                                                    <TextBlock Grid.Column="1"
                                                               Text="{x:Bind Name}"
                                                               TextWrapping="Wrap"
                                                               VerticalAlignment="Center" />
                                                    <TextBlock Grid.Column="2"
                                                               Text="{x:Bind Command}"
                                                               TextWrapping="Wrap"
                                                               FontFamily="Consolas"
                                                               IsTextSelectionEnabled="True"
                                                               VerticalAlignment="Center" />
                                                    <TextBlock Grid.Column="3"
                                                               Text="{x:Bind Unicode}"
                                                               TextWrapping="Wrap"
                                                               FontFamily="Consolas"
                                                               IsTextSelectionEnabled="True"
                                                               VerticalAlignment="Center" />
                                                </Grid>
                                            </DataTemplate>
                                        </ItemsRepeater.ItemTemplate>
                                    </ItemsRepeater>
                                </ScrollView>
                            </Grid>
                        </ContentPresenter>
                    </ScrollViewer>
                    <ScrollViewer x:Name="StructuresTable"
                                  HorizontalScrollBarVisibility="Auto"
                                  HorizontalScrollMode="Auto"
                                  VerticalScrollBarVisibility="Hidden"
                                  Visibility="Collapsed"
                                  BorderThickness="1"
                                  BorderBrush="{ThemeResource SurfaceStrokeColorDefaultBrush}"
                                  CornerRadius="4">
                        <ContentPresenter>
                            <Grid Background="{ThemeResource AcrylicBackgroundFillColorBaseBrush}">
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <Grid HorizontalAlignment="Stretch"
                                      Padding="12 16"
                                      BorderThickness="0,0,0,1"
                                      BorderBrush="{ThemeResource SurfaceStrokeColorDefaultBrush}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="150" />
                                        <ColumnDefinition Width="250" />
                                        <ColumnDefinition Width="200" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Text="Structure"
                                               Padding="8 0" />
                                    <TextBlock Grid.Column="1"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Text="Name" />
                                    <TextBlock Grid.Column="2"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Text="Command" />
                                </Grid>
                                <ScrollView Grid.Row="1"
                                            HorizontalScrollBarVisibility="Auto"
                                            HorizontalScrollMode="Auto"
                                            MaxHeight="450"
                                            CornerRadius="0">
                                    <ItemsRepeater x:Name="MathStructuresItems">
                                        <ItemsRepeater.Layout>
                                            <StackLayout Orientation="Vertical" />
                                        </ItemsRepeater.Layout>
                                        <ItemsRepeater.ItemTemplate>
                                            <DataTemplate x:DataType="helper:MathStucture">
                                                <Grid x:Name="StructureDataTemplate"
                                                      Padding="12"
                                                      Loading="StructureDataTemplate_Loading"
                                                      BorderThickness="0,0,0,1"
                                                      BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="150" />
                                                        <ColumnDefinition Width="250" />
                                                        <ColumnDefinition Width="200" />
                                                    </Grid.ColumnDefinitions>
                                                    <Button x:Name="InsertStructureBtn"
                                                            VerticalAlignment="Center"
                                                            Tag="{x:Bind Command}"
                                                            IsTabStop="False"
                                                            Padding="-8 4 -8 -8"
                                                            Width="80"
                                                            Click="InsertStructureBtn_Click">
                                                        <StackPanel>
                                                            <Image x:Name="LightThemeImage"
                                                                   Stretch="None"
                                                                   Source="{x:Bind LightImageSource}"
                                                                   Loaded="LightThemeImage_Loaded"
                                                                   ActualThemeChanged="LightThemeImage_ActualThemeChanged" />
                                                            <Image x:Name="DarkThemeImage"
                                                                   Stretch="None"
                                                                   Source="{x:Bind DarkImageSource}"
                                                                   Loaded="DarkThemeImage_Loaded"
                                                                   ActualThemeChanged="DarkThemeImage_ActualThemeChanged" />
                                                        </StackPanel>
                                                        <ToolTipService.ToolTip>
                                                            <x:String>Insert Structure</x:String>
                                                        </ToolTipService.ToolTip>
                                                    </Button>
                                                    <TextBlock Grid.Column="1"
                                                               Text="{x:Bind Name}"
                                                               TextWrapping="Wrap"
                                                               VerticalAlignment="Center" />
                                                    <TextBlock Grid.Column="2"
                                                               Text="{x:Bind Command}"
                                                               TextWrapping="Wrap"
                                                               FontFamily="Consolas"
                                                               IsTextSelectionEnabled="True"
                                                               VerticalAlignment="Center" />
                                                </Grid>
                                            </DataTemplate>
                                        </ItemsRepeater.ItemTemplate>
                                    </ItemsRepeater>
                                </ScrollView>
                            </Grid>
                        </ContentPresenter>
                    </ScrollViewer>
                </StackPanel>
            </controls:ControlExample.Example>
            <controls:ControlExample.Xaml>
                <x:String xml:space="preserve">
&lt;RichEditBox x:Name="mathEditor" FontSize="16" /&gt;
                </x:String>
            </controls:ControlExample.Xaml>
            <controls:ControlExample.CSharp>
                <x:String xml:space="preserve">
mathEditor.TextDocument.SetMathMode(RichEditMathMode.MathOnly);
                </x:String>
            </controls:ControlExample.CSharp>
        </controls:ControlExample>
    </StackPanel>
</Page>
